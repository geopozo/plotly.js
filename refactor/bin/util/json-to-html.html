<!DOCTYPE html>
<html>
  <head>
    <link rel=stylesheet href=./style.css></link>
    <script>
      function fixWidth(on) {
        console.log("Here");
        var style = document.styleSheets[0].cssRules || document.styleSheets[0].rules;
        size = document.getElementById("fixwidth").value;
        for (var i = 0; i < style.length; i++) {
          if (style[i].selectorText == '.description') {
            if(on) {
              size = size + 'px';
            } else {
              size = "auto";
            }
            style[i].style['width'] = size;
          }
        }
      }
      var i = 6;
      function createNode() {
        var node = document.createElement("div");
        var description = document.createElement("div");
        var container = document.createElement("div");
        node.className = "node";
        node.id = String(i++);
        description.className = "description";
        container.className = "node-container";
        var text = "";
        for (let i = 0; i < Math.floor(Math.random() * 4) + 1; i++) {
          text += "Lorem ipsum ";
        }
        description.innerHTML = text;
        node.appendChild(description);
        node.appendChild(container);
        node.onclick = addNode;
        console.log(node.innerHTML);
        return node;
      }
      function addNode(e) {
        let target = e.target;
        while (target && target.className != "node") {
          target = target.parentNode;
        }
        setTimeout((target) => {
          target.style.transition = "";
          target.style.backgroundColor = "red";
        }, 0, target);
        setTimeout((target) => {
          target.style.backgroundColor = "white";
          target.style.transition="background-color 1s ease";
        }, 20, target);
        const newNode = createNode();
        const parent = target.querySelector(".node-container");
        parent.appendChild(newNode);
        event.stopPropagation();
      }
      window.onload = () => {
        const nodes = document.querySelectorAll(".node");
        Array.prototype.map.call(nodes,
          (el) => {
            el.onclick = addNode;
          }
        );
      };
    </script>
  </head>
  <body>
    <div class="root node-container">
      <div class="node" id="0">
        <div class=description>1</div>
        <div class="node-container">
          <div class="node" id="1">
            <div class=description>1a</div>
            <div class="node-container">
              <div class="node" id="2">
                <div class=description>1aAlpha</div>
                <div class="node-container"></div>
              </div>
              <div class="node" id="3">
                <div class=description>1aBeta</div>
                <div class="node-container"></div>
              </div>
            </div>
          </div>
          <div class="node" id="4">
            <div class=description>1b</div>
            <div class="node-container"></div>
          </div>
        </div>
      </div>
      <div class="node" id="5">
        <div class=description>2</div>
        <div class="node-container"></div>
      </div>
    <div id="toolbar">
      Fix Description Width: <input type=text size=3 id="fixwidth" /> <button onclick="fixWidth(true)">Fix Width</button>
      <button onclick="fixWidth(false)">Unfix width</button>
    </div>
    </div>
  </body>
</html>

